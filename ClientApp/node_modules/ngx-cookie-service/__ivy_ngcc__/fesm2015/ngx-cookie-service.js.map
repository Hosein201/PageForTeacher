{"version":3,"file":"ngx-cookie-service.js","sources":["../../projects/ngx-cookie-service/src/lib/cookie.service.ts","../../../projects/ngx-cookie-service/src/public-api.ts","../../../projects/ngx-cookie-service/src/ngx-cookie-service.ts"],"names":[],"mappings":"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","sourcesContent":["// This service is based on the `ng2-cookies` package which sadly is not a service and does\n// not use `DOCUMENT` injection and therefore doesn't work well with AoT production builds.\n// Package: https://github.com/BCJTI/ng2-cookies\n\nimport { Injectable, Inject, PLATFORM_ID, InjectionToken } from '@angular/core';\nimport { DOCUMENT, isPlatformBrowser } from '@angular/common';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class CookieService {\n  private readonly documentIsAccessible: boolean;\n\n  constructor(\n    // The type `Document` may not be used here. Although a fix is on its way,\n    // we will go with `any` for now to support Angular 2.4.x projects.\n    // Issue: https://github.com/angular/angular/issues/12631\n    // Fix: https://github.com/angular/angular/pull/14894\n    @Inject(DOCUMENT) private document: any,\n    // Get the `PLATFORM_ID` so we can check if we're in a browser.\n    @Inject(PLATFORM_ID) private platformId: InjectionToken<object>\n  ) {\n    this.documentIsAccessible = isPlatformBrowser(this.platformId);\n  }\n\n  /**\n   * @param name Cookie name\n   * @returns boolean - whether cookie with specified name exists\n   */\n  check(name: string): boolean {\n    if (!this.documentIsAccessible) {\n      return false;\n    }\n\n    name = encodeURIComponent(name);\n\n    const regExp: RegExp = this.getCookieRegExp(name);\n    const exists: boolean = regExp.test(this.document.cookie);\n\n    return exists;\n  }\n\n  /**\n   * @param name Cookie name\n   * @returns property value\n   */\n  get(name: string): string {\n    if (this.documentIsAccessible && this.check(name)) {\n      name = encodeURIComponent(name);\n\n      const regExp: RegExp = this.getCookieRegExp(name);\n      const result: RegExpExecArray = regExp.exec(this.document.cookie);\n\n      return this.safeDecodeURIComponent(result[1]);\n    } else {\n      return '';\n    }\n  }\n\n  /**\n   * @returns all the cookies in json\n   */\n  getAll(): { [key: string]: string } {\n    if (!this.documentIsAccessible) {\n      return {};\n    }\n\n    const cookies: { [key: string]: string } = {};\n    const document: any = this.document;\n\n    if (document.cookie && document.cookie !== '') {\n      document.cookie.split(';').forEach((currentCookie) => {\n        const [cookieName, cookieValue] = currentCookie.split('=');\n        cookies[this.safeDecodeURIComponent(cookieName.replace(/^ /, ''))] = this.safeDecodeURIComponent(cookieValue);\n      });\n    }\n\n    return cookies;\n  }\n\n  /**\n   * @param name     Cookie name\n   * @param value    Cookie value\n   * @param expires  Number of days until the cookies expires or an actual `Date`\n   * @param path     Cookie path\n   * @param domain   Cookie domain\n   * @param secure   Secure flag\n   * @param sameSite OWASP samesite token `Lax`, `None`, or `Strict`. Defaults to `Lax`\n   */\n  set(name: string, value: string, expires?: number | Date, path?: string, domain?: string, secure?: boolean, sameSite?: 'Lax' | 'None' | 'Strict'): void;\n\n  /**\n   * Cookie's parameters:\n   * <pre>\n   * expires  Number of days until the cookies expires or an actual `Date`\n   * path     Cookie path\n   * domain   Cookie domain\n   * secure   Secure flag\n   * sameSite OWASP samesite token `Lax`, `None`, or `Strict`. Defaults to `Lax`\n   * </pre>\n   * @param name     Cookie name\n   * @param value    Cookie value\n   * @param options  Body with cookie's params\n   */\n  set(\n    name: string,\n    value: string,\n    options?: {\n      expires?: number | Date;\n      path?: string;\n      domain?: string;\n      secure?: boolean;\n      sameSite?: 'Lax' | 'None' | 'Strict';\n    }\n  ): void;\n\n  set(\n    name: string,\n    value: string,\n    expiresOrOptions?: number | Date | any,\n    path?: string,\n    domain?: string,\n    secure?: boolean,\n    sameSite?: 'Lax' | 'None' | 'Strict'\n  ): void {\n    if (!this.documentIsAccessible) {\n      return;\n    }\n\n    if (typeof expiresOrOptions === 'number' || expiresOrOptions instanceof Date || path || domain || secure || sameSite) {\n      const optionsBody = {\n        expires: expiresOrOptions,\n        path,\n        domain,\n        secure,\n        sameSite: sameSite ? sameSite : 'Lax',\n      };\n\n      this.set(name, value, optionsBody);\n      return;\n    }\n\n    let cookieString: string = encodeURIComponent(name) + '=' + encodeURIComponent(value) + ';';\n\n    const options = expiresOrOptions ? expiresOrOptions : {};\n\n    if (options.expires) {\n      if (typeof options.expires === 'number') {\n        const dateExpires: Date = new Date(new Date().getTime() + options.expires * 1000 * 60 * 60 * 24);\n\n        cookieString += 'expires=' + dateExpires.toUTCString() + ';';\n      } else {\n        cookieString += 'expires=' + options.expires.toUTCString() + ';';\n      }\n    }\n\n    if (options.path) {\n      cookieString += 'path=' + options.path + ';';\n    }\n\n    if (options.domain) {\n      cookieString += 'domain=' + options.domain + ';';\n    }\n\n    if (options.secure === false && options.sameSite === 'None') {\n      options.secure = true;\n      console.warn(\n        `[ngx-cookie-service] Cookie ${name} was forced with secure flag because sameSite=None.` +\n          `More details : https://github.com/stevermeister/ngx-cookie-service/issues/86#issuecomment-597720130`\n      );\n    }\n    if (options.secure) {\n      cookieString += 'secure;';\n    }\n\n    if (!options.sameSite) {\n      options.sameSite = 'Lax';\n    }\n\n    cookieString += 'sameSite=' + options.sameSite + ';';\n\n    this.document.cookie = cookieString;\n  }\n\n  /**\n   * @param name   Cookie name\n   * @param path   Cookie path\n   * @param domain Cookie domain\n   */\n  delete(name: string, path?: string, domain?: string, secure?: boolean, sameSite: 'Lax' | 'None' | 'Strict' = 'Lax'): void {\n    if (!this.documentIsAccessible) {\n      return;\n    }\n    const expiresDate = new Date('Thu, 01 Jan 1970 00:00:01 GMT');\n    this.set(name, '', { expires: expiresDate, path, domain, secure, sameSite });\n  }\n\n  /**\n   * @param path   Cookie path\n   * @param domain Cookie domain\n   */\n  deleteAll(path?: string, domain?: string, secure?: boolean, sameSite: 'Lax' | 'None' | 'Strict' = 'Lax'): void {\n    if (!this.documentIsAccessible) {\n      return;\n    }\n\n    const cookies: any = this.getAll();\n\n    for (const cookieName in cookies) {\n      if (cookies.hasOwnProperty(cookieName)) {\n        this.delete(cookieName, path, domain, secure, sameSite);\n      }\n    }\n  }\n\n  /**\n   * @param name Cookie name\n   * @returns property RegExp\n   */\n  private getCookieRegExp(name: string): RegExp {\n    const escapedName: string = name.replace(/([\\[\\]\\{\\}\\(\\)\\|\\=\\;\\+\\?\\,\\.\\*\\^\\$])/gi, '\\\\$1');\n\n    return new RegExp('(?:^' + escapedName + '|;\\\\s*' + escapedName + ')=(.*?)(?:;|$)', 'g');\n  }\n\n  private safeDecodeURIComponent(encodedURIComponent: string): string {\n    try {\n      return decodeURIComponent(encodedURIComponent);\n    } catch {\n      // probably it is not uri encoded. return as is\n      return encodedURIComponent;\n    }\n  }\n}\n","/*\n * Public API Surface of ngx-cookie-service\n */\n\nexport * from './lib/cookie.service';\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public-api';\n"]}